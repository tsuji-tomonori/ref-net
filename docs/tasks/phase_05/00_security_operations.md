# Task: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‹ç”¨ãƒ—ãƒ­ã‚»ã‚¹ã®ç¢ºç«‹

## ã‚¿ã‚¹ã‚¯ã®ç›®çš„

å®šæœŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»æ‰‹é †ã¨ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒ—ãƒ­ã‚»ã‚¹ã‚’ç­–å®šãƒ»å®Ÿè£…ã—ã€ç¶™ç¶šçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¶­æŒä½“åˆ¶ã‚’ç¢ºç«‹ã™ã‚‹ã€‚

## å‰ææ¡ä»¶

- Phase 4ãŒå®Œäº†ã—ã¦ã„ã‚‹
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ ãŒç¨¼åƒä¸­
- ã‚·ã‚¹ãƒ†ãƒ ãŒæœ¬ç•ªç¨¼åƒã—ã¦ã„ã‚‹
- åŸºæœ¬çš„ãªç›£è¦–ä½“åˆ¶ãŒæ§‹ç¯‰æ¸ˆã¿

## å®Ÿæ–½å†…å®¹

### 1. å®šæœŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã®ä½œæˆ

#### docs/security/security_audit_checklist.md (æ–°è¦ä½œæˆ)

```markdown
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

## å®Ÿæ–½é »åº¦
- æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯ï¼šæ¯æ—¥å®Ÿæ–½
- é€±æ¬¡ãƒã‚§ãƒƒã‚¯ï¼šæ¯é€±æœˆæ›œæ—¥å®Ÿæ–½
- æœˆæ¬¡ãƒã‚§ãƒƒã‚¯ï¼šæ¯æœˆ1æ—¥å®Ÿæ–½
- å››åŠæœŸãƒã‚§ãƒƒã‚¯ï¼šå››åŠæœŸåˆæœˆã®1æ—¥å®Ÿæ–½

## æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯é …ç›®

### èªè¨¼ãƒ»èªå¯
- [ ] èªè¨¼å¤±æ•—ãƒ­ã‚°ï¼ˆ5å›/åˆ†ä»¥ä¸Šã®é€£ç¶šå¤±æ•—ãŒãªã„ã‹ï¼‰
- [ ] ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œï¼ˆé€šå¸¸ã¨ã¯ç•°ãªã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼‰
- [ ] Flower UIã¸ã®æœªèªè¨¼ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œ

### ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- [ ] ãƒ¬ãƒ¼ãƒˆåˆ¶é™ç™ºå‹•çŠ¶æ³ï¼ˆç•°å¸¸ãªç™ºå‹•é »åº¦ãŒãªã„ã‹ï¼‰
- [ ] APIå¿œç­”æ™‚é–“ï¼ˆå¹³å‡5ç§’ä»¥å†…ã‚’ç¶­æŒï¼‰
- [ ] ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨ç‡ï¼ˆCPU 70%æœªæº€ã€ãƒ¡ãƒ¢ãƒª 80%æœªæº€ï¼‰

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°
- [ ] é‡è¦åº¦ã€Œhighã€ã€Œcriticalã€ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆç¢ºèª
- [ ] ãƒ­ã‚°ã®æ¬ æï¼ˆ24æ™‚é–“ä»¥å†…ã®ãƒ­ã‚°ãŒå­˜åœ¨ã™ã‚‹ã‹ï¼‰
- [ ] ç•°å¸¸ãªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ‘ã‚¿ãƒ¼ãƒ³

## é€±æ¬¡ãƒã‚§ãƒƒã‚¯é …ç›®

### è¨¼æ˜æ›¸ãƒ»æš—å·åŒ–
- [ ] SSLè¨¼æ˜æ›¸ã®æœ‰åŠ¹æœŸé™ï¼ˆ30æ—¥å‰ã«è­¦å‘Šï¼‰
- [ ] TLSè¨­å®šã®ç¢ºèªï¼ˆä¸æ­£ãªå¤‰æ›´ãŒãªã„ã‹ï¼‰
- [ ] ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´å±¥æ­´ã®ç¢ºèª

### ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®å¦¥å½“æ€§ç¢ºèª
- [ ] ç®¡ç†è€…æ¨©é™ã®ä½¿ç”¨å±¥æ­´ç¢ºèª
- [ ] ä¸è¦ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å­˜åœ¨ç¢ºèª

### ã‚·ã‚¹ãƒ†ãƒ æ›´æ–°
- [ ] ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³å®Ÿè¡Œ
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒã®é©ç”¨çŠ¶æ³ç¢ºèª
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®å®Œå…¨æ€§ç¢ºèª

## æœˆæ¬¡ãƒã‚§ãƒƒã‚¯é …ç›®

### åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡
- [ ] ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã®å®Ÿæ–½
- [ ] è„†å¼±æ€§è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆã®ä½œæˆ
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆçµ±è¨ˆã®åˆ†æ
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã®è¦‹ç›´ã—

### ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹
- [ ] ç›£æŸ»ãƒ­ã‚°ã®å®Œå…¨æ€§ç¢ºèª
- [ ] ãƒ‡ãƒ¼ã‚¿ä¿è­·è¦å‰‡ã¸ã®æº–æ‹ ç¢ºèª
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®å®Ÿæ–½çŠ¶æ³

## å››åŠæœŸãƒã‚§ãƒƒã‚¯é …ç›®

### æˆ¦ç•¥çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆ¦ç•¥ã®è¦‹ç›´ã—
- [ ] è„…å¨ãƒ¢ãƒ‡ãƒ«ã®æ›´æ–°
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æŠ•è³‡ã®åŠ¹æœæ¸¬å®š
- [ ] ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œè¨ˆç”»ã®è¦‹ç›´ã—
```

### 2. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒ—ãƒ­ã‚»ã‚¹ã®ç­–å®š

#### docs/security/incident_response_procedure.md (æ–°è¦ä½œæˆ)

```markdown
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œæ‰‹é †

## ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆåˆ†é¡

### ãƒ¬ãƒ™ãƒ«1ï¼šè»½å¾®ï¼ˆæƒ…å ±åé›†ï¼‰
- èªè¨¼å¤±æ•—ã®å¢—åŠ 
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®é »ç¹ãªç™ºå‹•
- è»½å¾®ãªè¨­å®šãƒŸã‚¹

**å¯¾å¿œæ™‚é–“ï¼š24æ™‚é–“ä»¥å†…**

### ãƒ¬ãƒ™ãƒ«2ï¼šä¸­ç¨‹åº¦ï¼ˆæ³¨æ„ãŒå¿…è¦ï¼‰
- ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã®ç–‘ã„
- ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ç•°å¸¸
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼é•å

**å¯¾å¿œæ™‚é–“ï¼š4æ™‚é–“ä»¥å†…**

### ãƒ¬ãƒ™ãƒ«3ï¼šæ·±åˆ»ï¼ˆç·Šæ€¥å¯¾å¿œï¼‰
- ãƒ‡ãƒ¼ã‚¿æ¼æ´©ã®ç–‘ã„
- ã‚·ã‚¹ãƒ†ãƒ ä¾µå®³ã®ç¢ºèª
- ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ã‚’ä¼´ã†æ”»æ’ƒ

**å¯¾å¿œæ™‚é–“ï¼š1æ™‚é–“ä»¥å†…**

### ãƒ¬ãƒ™ãƒ«4ï¼šè‡´å‘½çš„ï¼ˆå³åº§å¯¾å¿œï¼‰
- ãƒ‡ãƒ¼ã‚¿ã®å¤§é‡æ¼æ´©
- ã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨ä¾µå®³
- ãƒ©ãƒ³ã‚µãƒ ã‚¦ã‚§ã‚¢æ„ŸæŸ“

**å¯¾å¿œæ™‚é–“ï¼šå³åº§**

## å¯¾å¿œæ‰‹é †

### åˆæœŸå¯¾å¿œï¼ˆå…¨ãƒ¬ãƒ™ãƒ«å…±é€šï¼‰
1. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®è¨˜éŒ²ãƒ»å ±å‘Š
2. å½±éŸ¿ç¯„å›²ã®ç‰¹å®š
3. ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆ¤æ–­
4. ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼ã¸ã®é€šçŸ¥

### èª¿æŸ»ãƒ»åˆ†æ
1. ãƒ­ã‚°åˆ†æã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆè©³ç´°èª¿æŸ»
2. æ”»æ’ƒãƒ™ã‚¯ã‚¿ãƒ¼ã®ç‰¹å®š
3. è¢«å®³ç¯„å›²ã®ç¢ºå®š
4. æ ¹æœ¬åŸå› ã®åˆ†æ

### å°ã˜è¾¼ã‚ãƒ»æ ¹çµ¶
1. æ”»æ’ƒã®å°ã˜è¾¼ã‚ï¼ˆå¿…è¦ã«å¿œã˜ã¦ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ï¼‰
2. è„†å¼±æ€§ã®ä¿®æ­£
3. æ”»æ’ƒè€…ã‚¢ã‚¯ã‚»ã‚¹ã®æ’é™¤
4. ã‚·ã‚¹ãƒ†ãƒ ã®å¾©æ—§

### å¾©æ—§ãƒ»äº‹å¾Œå¯¾å¿œ
1. ã‚µãƒ¼ãƒ“ã‚¹ã®æ®µéšçš„å¾©æ—§
2. ç›£è¦–ä½“åˆ¶ã®å¼·åŒ–
3. å†ç™ºé˜²æ­¢ç­–ã®å®Ÿè£…
4. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå ±å‘Šæ›¸ã®ä½œæˆ

## é€£çµ¡å…ˆãƒ»ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### æŠ€è¡“ãƒãƒ¼ãƒ 
- ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ï¼š[é€£çµ¡å…ˆ]
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ‹…å½“ï¼š[é€£çµ¡å…ˆ]
- é–‹ç™ºè²¬ä»»è€…ï¼š[é€£çµ¡å…ˆ]

### ç®¡ç†è·
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼š[é€£çµ¡å…ˆ]
- CTOï¼š[é€£çµ¡å…ˆ]

### å¤–éƒ¨æ©Ÿé–¢
- æ³•åŸ·è¡Œæ©Ÿé–¢ï¼š[é€£çµ¡å…ˆ]
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ãƒ³ãƒ€ãƒ¼ï¼š[é€£çµ¡å…ˆ]
```

### 3. ç›£æŸ»ãƒ»ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

#### scripts/security_monitoring.py (æ–°è¦ä½œæˆ)

```python
#!/usr/bin/env python3
"""ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ãƒ»ç›£æŸ»ã‚¹ã‚¯ãƒªãƒ—ãƒˆ."""

import argparse
import json
from datetime import datetime, timedelta
from typing import Dict, List

import structlog
from refnet_shared.security.audit_logger import security_audit_logger

logger = structlog.get_logger(__name__)


class SecurityMonitor:
    """ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã‚¯ãƒ©ã‚¹."""

    def __init__(self):
        """åˆæœŸåŒ–."""
        self.thresholds = {
            "auth_failures_per_minute": 5,
            "rate_limit_threshold": 10,
            "response_time_threshold": 5.0,
            "cpu_threshold": 70.0,
            "memory_threshold": 80.0
        }

    def check_authentication_failures(self, time_window: int = 60) -> Dict:
        """èªè¨¼å¤±æ•—ã®ç›£è¦–."""
        # éå»time_windowåˆ†ã®èªè¨¼å¤±æ•—ãƒ­ã‚°ã‚’ç¢ºèª
        # å®Ÿè£…ã§ã¯ç›£æŸ»ãƒ­ã‚°ã‹ã‚‰èªè¨¼å¤±æ•—ã‚¤ãƒ™ãƒ³ãƒˆã‚’æŠ½å‡º
        return {
            "status": "ok",
            "failures": 2,
            "threshold": self.thresholds["auth_failures_per_minute"],
            "alert": False
        }

    def check_rate_limiting(self, time_window: int = 60) -> Dict:
        """ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®ç›£è¦–."""
        # ãƒ¬ãƒ¼ãƒˆåˆ¶é™ç™ºå‹•çŠ¶æ³ã®ç¢ºèª
        return {
            "status": "ok",
            "rate_limit_events": 3,
            "threshold": self.thresholds["rate_limit_threshold"],
            "alert": False
        }

    def check_ssl_certificates(self) -> Dict:
        """SSLè¨¼æ˜æ›¸ã®æœ‰åŠ¹æœŸé™ç¢ºèª."""
        # è¨¼æ˜æ›¸ã®æœ‰åŠ¹æœŸé™ã‚’ãƒã‚§ãƒƒã‚¯
        return {
            "status": "ok",
            "days_until_expiry": 90,
            "certificate_path": "/etc/nginx/ssl/server.crt",
            "alert": False
        }

    def check_system_resources(self) -> Dict:
        """ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨ç‡ç¢ºèª."""
        # CPUãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ã®ç¢ºèª
        return {
            "status": "ok",
            "cpu_usage": 45.2,
            "memory_usage": 62.1,
            "alert": False
        }

    def daily_security_check(self) -> Dict:
        """æ—¥æ¬¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯."""
        results = {
            "timestamp": datetime.now().isoformat(),
            "check_type": "daily",
            "checks": {
                "authentication": self.check_authentication_failures(),
                "rate_limiting": self.check_rate_limiting(),
                "ssl_certificates": self.check_ssl_certificates(),
                "system_resources": self.check_system_resources()
            }
        }

        # ã‚¢ãƒ©ãƒ¼ãƒˆãŒå¿…è¦ãªã‚‚ã®ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        alerts = [check for check in results["checks"].values() if check.get("alert")]
        results["alerts_count"] = len(alerts)
        results["status"] = "alert" if alerts else "ok"

        return results

    def generate_report(self, results: Dict) -> str:
        """ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ."""
        report = f"""
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆ
å®Ÿè¡Œæ—¥æ™‚: {results['timestamp']}
ãƒã‚§ãƒƒã‚¯ç¨®åˆ¥: {results['check_type']}
ç·åˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: {results['status']}
ã‚¢ãƒ©ãƒ¼ãƒˆæ•°: {results['alerts_count']}

## ãƒã‚§ãƒƒã‚¯çµæœè©³ç´°
"""

        for check_name, check_result in results["checks"].items():
            status_icon = "ğŸš¨" if check_result.get("alert") else "âœ…"
            report += f"{status_icon} {check_name}: {check_result['status']}\n"

        return report


def main():
    """ãƒ¡ã‚¤ãƒ³å‡¦ç†."""
    parser = argparse.ArgumentParser(description="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ")
    parser.add_argument("--check-type", choices=["daily", "weekly", "monthly"],
                       default="daily", help="ãƒã‚§ãƒƒã‚¯ç¨®åˆ¥")
    parser.add_argument("--output", help="ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«")

    args = parser.parse_args()

    monitor = SecurityMonitor()

    if args.check_type == "daily":
        results = monitor.daily_security_check()
    else:
        # é€±æ¬¡ãƒ»æœˆæ¬¡ãƒã‚§ãƒƒã‚¯ã¯å°†æ¥å®Ÿè£…
        results = {"error": f"{args.check_type} check not implemented yet"}

    # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ»å‡ºåŠ›
    report = monitor.generate_report(results)

    if args.output:
        with open(args.output, "w") as f:
            f.write(report)
        logger.info("Security report generated", file=args.output)
    else:
        print(report)

    # JSONå½¢å¼ã§ã‚‚å‡ºåŠ›
    print(json.dumps(results, indent=2))


if __name__ == "__main__":
    main()
```

### 4. å®šæœŸå®Ÿè¡Œè¨­å®š

#### scripts/setup_security_cron.sh (æ–°è¦ä½œæˆ)

```bash
#!/bin/bash

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã®å®šæœŸå®Ÿè¡Œè¨­å®š

SCRIPT_DIR="/app/scripts"
LOG_DIR="/app/logs/security"
REPORT_DIR="/app/reports/security"

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p "$LOG_DIR"
mkdir -p "$REPORT_DIR"

# crontabè¨­å®š
cat << EOF > /tmp/security_cron
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã®å®šæœŸå®Ÿè¡Œ
# æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯ï¼ˆæ¯æ—¥9:00ï¼‰
0 9 * * * cd /app && python scripts/security_monitoring.py --check-type daily --output "$REPORT_DIR/daily_$(date +\%Y\%m\%d).txt" >> "$LOG_DIR/security_monitoring.log" 2>&1

# é€±æ¬¡ãƒã‚§ãƒƒã‚¯ï¼ˆæ¯é€±æœˆæ›œæ—¥10:00ï¼‰
0 10 * * 1 cd /app && python scripts/security_monitoring.py --check-type weekly --output "$REPORT_DIR/weekly_$(date +\%Y\%m\%d).txt" >> "$LOG_DIR/security_monitoring.log" 2>&1

# æœˆæ¬¡ãƒã‚§ãƒƒã‚¯ï¼ˆæ¯æœˆ1æ—¥11:00ï¼‰
0 11 1 * * cd /app && python scripts/security_monitoring.py --check-type monthly --output "$REPORT_DIR/monthly_$(date +\%Y\%m\%d).txt" >> "$LOG_DIR/security_monitoring.log" 2>&1
EOF

# crontabç™»éŒ²
crontab /tmp/security_cron
rm /tmp/security_cron

echo "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã®å®šæœŸå®Ÿè¡ŒãŒè¨­å®šã•ã‚Œã¾ã—ãŸã€‚"
echo "ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: $LOG_DIR"
echo "ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: $REPORT_DIR"
```

## å®Œäº†æ¡ä»¶

### å¿…é ˆæ¡ä»¶
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œæ‰‹é †ãŒæ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ã‚‹
- [ ] ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆæ¸ˆã¿
- [ ] å®šæœŸå®Ÿè¡ŒãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] åˆå›ã®ç›£æŸ»ãŒå®Ÿæ–½ã•ã‚Œã€çµæœãŒç¢ºèªã•ã‚Œã¦ã„ã‚‹

### é‹ç”¨ç¢ºèª
- [ ] æ—¥æ¬¡ç›£æŸ»ãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹
- [ ] ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆåˆ†é¡ãƒ»ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ˜ç¢ºã§ã‚ã‚‹
- [ ] ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆãŒé©åˆ‡ã«ç”Ÿæˆã•ã‚Œã‚‹
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥ãŒå‹•ä½œã™ã‚‹
- [ ] æ‰‹é †æ›¸ã«å¾“ã£ãŸå¯¾å¿œãƒ†ã‚¹ãƒˆãŒå®Ÿæ–½ã•ã‚Œã¦ã„ã‚‹

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [ ] é‹ç”¨æ‰‹é †æ›¸ãŒä½œæˆãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼æ¸ˆã¿
- [ ] æ‹…å½“è€…å‘ã‘ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°è³‡æ–™ãŒæº–å‚™ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é€£çµ¡å…ˆãŒæœ€æ–°ã§ã‚ã‚‹

## æ¨å®šä½œæ¥­æ™‚é–“

**8-12æ™‚é–“**
- ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆä½œæˆï¼š2-3æ™‚é–“
- ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œæ‰‹é †ç­–å®šï¼š3-4æ™‚é–“
- ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè£…ï¼š2-3æ™‚é–“
- ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ï¼š1-2æ™‚é–“

## å„ªå…ˆåº¦

**ğŸ“‹ ä¸­å„ªå…ˆåº¦** - Phase 4å®Œäº†å¾Œã®é‹ç”¨ãƒ•ã‚§ãƒ¼ã‚ºã§å¯¾å¿œ

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

- 01_vulnerability_management.md ã§ã®è„†å¼±æ€§ç®¡ç†ä½“åˆ¶ç¢ºç«‹
- é‹ç”¨ãƒãƒ¼ãƒ ã¸ã®æ‰‹é †å…±æœ‰ãƒ»ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å®Ÿæ–½
- ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆæ¤œè¨
