# RefNet 開発フェーズ管理

## 概要

RefNet論文関係性可視化システムの開発を効率的に進めるため、機能と依存関係に基づいて4つのフェーズに分割して実装します。各フェーズは明確な目的と完了条件を持ち、次のフェーズの前提条件となります。

## フェーズ構成

### Phase 1: プロジェクト基盤構築
**目的**: 開発環境とプロジェクト構造の確立
**期間**: 4-5時間
**依存関係**: なし（プロジェクト開始点）

- プロジェクト全体構造の作成
- Monorepo環境の構築
- 共通ライブラリの基盤設定
- 環境設定管理システム

### Phase 2: データ基盤構築
**目的**: データモデルと永続化層の確立
**期間**: 4-5時間
**依存関係**: Phase 1完了

- SQLAlchemyモデル定義
- データベースマイグレーション設定
- 共通データアクセス層

### Phase 3: コアサービス開発
**目的**: ビジネスロジックとAPIの実装
**期間**: 16-20時間（並列開発可能）
**依存関係**: Phase 2完了

- APIゲートウェイサービス
- クローラーサービス
- 要約サービス
- Markdownジェネレーター

### Phase 4: インフラ・運用
**目的**: 本番運用に必要なインフラと運用機能
**期間**: 8-10時間（一部並列開発可能）
**依存関係**: Phase 3の基本機能完了

- Docker統合環境
- 監視・アラート機能
- セキュリティ・認証機能
- バッチ処理・スケジューリング

## 並列開発戦略

### Phase 1-2: 順次実行必須
- 全体の基盤となるため、順序通りに実行
- 一人の開発者が集中して実施

### Phase 3: 完全並列開発可能
- 各サービスは独立したworktreeで開発
- 4人の開発者が同時並行で実装可能
- 依存関係は共通基盤（Phase 2）のみ

### Phase 4: 部分並列開発可能
- Docker設定は独立して開始可能
- 監視・セキュリティは Phase 3 の基本機能完了後
- 2-3人の開発者で並列実装可能

## 完了基準

### 各フェーズの完了条件
- すべてのタスクの完了条件を満たす
- `moon :check` が全パッケージで正常終了
- フェーズ固有の統合テストが通る
- 次フェーズの前提条件が整備されている

### プロジェクト全体の完了条件
- 全フェーズの完了
- 論文取得→要約→Markdown生成の完全フローが動作
- Obsidianで論文ネットワークが可視化される
- 本番環境での安定稼働が可能

## 見積もり時間

| フェーズ | 順次実行時間 | 並列実行時間 | 最大並列人数 |
|----------|-------------|-------------|-------------|
| Phase 1 | 4-5時間 | 4-5時間 | 1人 |
| Phase 2 | 4-5時間 | 4-5時間 | 1人 |
| Phase 3 | 16-20時間 | 4-5時間 | 4人 |
| Phase 4 | 8-10時間 | 3-4時間 | 3人 |
| **合計** | **32-40時間** | **15-19時間** | **最大4人** |

並列開発により、約**60%の時間短縮**が期待できます。

### 時間短縮効果の根拠

**従来型順次開発**: 32-40時間
- Phase 1: 4-5時間（1人）
- Phase 2: 4-5時間（1人）
- Phase 3: 16-20時間（1人）
- Phase 4: 8-10時間（1人）

**並列開発アプローチ**: 15-19時間
- Phase 1-2: 8-10時間（順次実行必須）
- Phase 3: 4-5時間（4人並列、理論値16-20÷4）
- Phase 4: 3-4時間（3人並列、理論値8-10÷3）

**時間短縮効果の計算**:
- 最大短縮: (40-15)÷40 = 62.5%
- 最小短縮: (32-19)÷32 = 40.6%
- 期待値: 約60%（コミュニケーションオーバーヘッド10-15%を考慮）

## Git Worktree戦略

### Phase 1-2: メインブランチ
```bash
cd ~/project/ref-net
# Phase 1, 2はメインブランチで順次実行
```

### Phase 3: 各サービス用Worktree
```bash
# 各サービス用のworktree作成
git worktree add ../ref-net-worktrees/api claude/api-$(date +'%Y%m%d%H%M%S')
git worktree add ../ref-net-worktrees/crawler claude/crawler-$(date +'%Y%m%d%H%M%S')
git worktree add ../ref-net-worktrees/summarizer claude/summarizer-$(date +'%Y%m%d%H%M%S')
git worktree add ../ref-net-worktrees/generator claude/generator-$(date +'%Y%m%d%H%M%S')
```

### Phase 4: インフラ用Worktree
```bash
git worktree add ../ref-net-worktrees/infra claude/infra-$(date +'%Y%m%d%H%M%S')
```

## 品質管理

### 各フェーズで実施
- コーディング規約チェック（ruff）
- 型チェック（mypy）
- 単体テスト実行（pytest）
- テストカバレッジ80%以上

### フェーズ間で実施
- 統合テスト
- パフォーマンステスト（Phase 3以降）
- セキュリティチェック（Phase 4）

## 次のステップ

1. **Phase 1**: `phase_01/README.md` を参照してプロジェクト基盤構築を開始
2. **並列開発準備**: Phase 2完了後、worktree環境を構築
3. **チーム開発**: Phase 3でチームメンバーに各サービスを割り当て
4. **運用準備**: Phase 4で本番運用機能を実装

詳細な実装手順は各フェーズディレクトリ内のREADME.mdとタスクファイルを参照してください。

## レビュー観点

### フェーズ設計の妥当性
- [ ] 4フェーズの分割が論理的で、依存関係が適切に管理されているか
- [ ] 各フェーズの目的が明確で、成果物が次フェーズの要件を満たすか
- [ ] フェーズ間の境界が明確で、作業の重複や漏れがないか
- [ ] 完了条件が具体的で測定可能か

### 並列開発戦略
- [ ] 並列開発可能な範囲が適切に識別されているか
- [ ] worktree戦略がチーム開発に効果的か
- [ ] 競合やマージコンフリクトのリスクが最小化されているか
- [ ] 時間短縮効果（60%）が現実的で実現可能か

### スケジュールと工数見積もり
- [ ] 各フェーズの工数見積もりが現実的か
- [ ] 並列実行時の人数配分が適切か
- [ ] ボトルネックやクリティカルパスが特定されているか
- [ ] バッファ時間や遅延リスクが考慮されているか

### 技術的実現性
- [ ] 提案された技術スタックが要件を満たすか
- [ ] moonrepoとworktreeの組み合わせが効率的か
- [ ] 各サービス間の統合方法が明確か
- [ ] 段階的な動作確認方法が具体的か

### 品質管理体制
- [ ] 各フェーズでの品質チェック項目が十分か
- [ ] テストカバレッジ80%の目標が適切か
- [ ] 統合テストとE2Eテストの範囲が明確か
- [ ] CI/CDパイプラインとの整合性が取れているか

### チーム開発対応
- [ ] 開発者のスキルレベルが作業分担に考慮されているか
- [ ] コミュニケーション方法と頻度が適切か
- [ ] ドキュメント管理と知識共有の仕組みが整備されているか
- [ ] 進捗管理と課題追跡の方法が明確か

### リスク管理
- [ ] 技術的リスク（外部API依存等）が特定されているか
- [ ] スケジュール遅延時の対応策が計画されているか
- [ ] 品質問題や障害時のエスカレーション手順が明確か
- [ ] プロジェクト中断・再開時の手順が整備されているか

## リスク管理計画

### 外部API依存リスク

**リスク**: Semantic Scholar API、ArXiv APIの制限・障害
**対応策**:
- API呼び出し制限の事前調査と遵守（Semantic Scholar: 100req/sec、ArXiv: 3req/sec）
- 指数バックオフによるリトライ機構の実装
- フォールバック用の代替データソース準備（CrossRef API等）
- APIキーの複数アカウント準備とローテーション
- キャッシュ機構による重複リクエスト回避
- レート制限監視とアラート設定

### スケジュール遅延対応

**レベル1（軽微遅延: 10-20%）**:
- タスクの優先度再評価と非必須機能の後回し
- 個別タスクの工数見積もり見直し

**レベル2（中程度遅延: 20-40%）**:
- 並列開発体制の見直しと人員再配置
- Phase 4の一部機能を次期バージョンに移行
- 自動化可能な作業の洗い出しと実装

**レベル3（重大遅延: 40%以上）**:
- プロジェクトスコープの根本的見直し
- 最小実行可能プロダクト（MVP）への縮小
- ステークホルダーとの再調整
